<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Hub Quiz</title>
    <script>
        let quizData = [];
        let currentQuestionIndex = 0;

        function submitUrl() {
            const videoUrl = document.getElementById('videoUrl').value;
            fetch('/api/createQuiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ videoUrl })
            })
            .then(response => response.json())
            .then(data => {
                alert("Response: " + JSON.stringify(data));
                if (data.quiz) {
                    quizData = data.quiz;
                    document.getElementById('quizContainer').innerHTML = "";
                    showQuestion();
                }
            })
            .catch(error => console.error('Error:', error));
        }

        function showQuestion() {
            if (currentQuestionIndex < quizData.length) {
                const question = quizData[currentQuestionIndex];
                let quizHtml = `<h2>Question ${currentQuestionIndex + 1}: ${question.question}</h2>`;
                
                question.options.forEach((option, index) => {
                    quizHtml += `<button onclick="selectAnswer(${index})">${option}</button> `;
                });

                quizHtml += `<br><br>`;
                
                if (currentQuestionIndex === quizData.length - 1) {
                    quizHtml += `<input type="email" id="emailInput" placeholder="Enter your email"><br>`;
                    quizHtml += `<button onclick="submitQuiz()">Submit</button>`;
                } else {
                    quizHtml += `<button onclick="nextQuestion()">Next</button>`;
                }

                document.getElementById('quizContainer').innerHTML = quizHtml;
            }
        }

        function selectAnswer(index) {
            // Store selected answer if needed for future analysis
            console.log("Selected Answer:", quizData[currentQuestionIndex].options[index]);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function submitQuiz() {
            const email = document.getElementById('emailInput').value;
            if (!email) {
                alert("Please enter your email before submitting.");
                return;
            }

            fetch('/api/submitQuiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ quizData, email })
            })
            .then(response => response.json())
            .then(data => {
                alert("Quiz submitted! Check your email for results.");
                document.getElementById('quizContainer').innerHTML = "<h2>Thank you for participating!</h2>";
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
    <h1>AI Hub Quiz - <span id="quizFilename"></span></h1>
    <input type="text" id="videoUrl" placeholder="Enter YouTube Video URL">
    <button onclick="submitUrl()">Submit</button>
    <br><br>
    <div id="quizContainer"></div>
</body>
</html>






